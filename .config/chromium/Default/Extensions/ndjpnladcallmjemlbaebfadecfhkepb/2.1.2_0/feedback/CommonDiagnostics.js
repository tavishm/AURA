/*! Version=16.0.0.0 */
Type.registerNamespace("Diag"),Diag.ULSCat=function(){},Diag.ULSCat.prototype={msoulscat_ES_EWAJS:0,msoulscat_ES_EWAJSGrid:1,msoulscat_ES_EWAJSHeaderResize:2,msoulscat_ES_EWAJSKeyboard:3,msoulscat_ES_EWAJSTest:4,msoulscat_ES_EWAJSFloatingObjects:5,msoulscat_ES_EWAJSChart:6,msoulscat_ES_MobileEwa:7,msoulscat_ES_EWAJSBIExplore:8,msoulscat_ES_EWAJSNov:9,msoulscat_ES_EWAJSExcelEverywhere:10,msoulscat_ES_EWAJSTp:11,msoulscat_ES_EWAJSComment:12,msoulscat_bULS_Uploader:100,msoulscat_bULS_CachingHost:101,msoulscat_bULS_Core:102,msoulscat_Osi_MsoSpLogging:200,msoulscat_MSOSP_Error:201,msoulscat_MSOSP_FileMenuCommands:202,msoulscat_MSOSP_MsoSpRenameManager:203,msoulscat_MSOSP_CrossDocumentMessenger:204,msoulscat_MSOSP_ClientRequestManager:205,msoulscat_MSOSP_DownloadQueue:206,msoulscat_MSOSP_CommandUI:207,msoulscat_MSOSP_AppSettings:208,msoulscat_MSOSP_CommonDebug:209,msoulscat_MSOSP_DomUtils:210,msoulscat_MSOSP_OIC:211,msoulscat_MSOSP_AnonEdit:212,msoulscat_MSOSP_Activity:213,msoulscat_MSOSP_AnonCreate:214,msoulscat_MSOSP_O365ShellService:215,msoulscat_MSOSP_SaveToCloudStorage:216,msoulscat_MSOSP_SessionExpirationManager:217,msoulscat_MSOSP_TaskManager:218,msoulscat_MSOSP_SaveAsToHost:219,msoulscat_Wac_WordMerge:300,msoulscat_WAC_WordViewer:301,msoulscat_Wac_WordPresence:302,msoulscat_Wac_RevisionDiffer:303,msoulscat_Wac_WordCoauth:304,msoulscat_Wac_Replication:305,msoulscat_Wac_BrowserGeneral:306,msoulscat_Box4_CopyPaste:307,msoulscat_Wac_WordEditorFootnoteEndnote:308,msoulscat_Wac_WordEditorPageNumber:309,msoulscat_Wac_EventManager:310,msoulscat_Wac_WordEditorTableStyle:311,msoulscat_Wac_WordEditorFindReplace:312,msoulscat_Wac_FindReplace:313,msoulscat_Wac_WordEditorPageBreak:314,msoulscat_WAC_Box4Crash:315,msoulscat_Wac_WordEditorBlobFormatting:316,msoulscat_Wac_WordEditorHeaderFooter:317,msoulscat_Wac_WordEditorSelection:318,msoulscat_Wac_NodeLogger:319,msoulscat_Wac_TaskPaneFramework:320,msoulscat_Wac_Focus:321,msoulscat_Wac_ImageEditor:322,msoulscat_Wac_EditingView:323,msoulscat_Wac_Box4General:324,msoulscat_Wac_PeoplesWell:325,msoulscat_Wac_PageView:326,msoulscat_Wac_Comments:327,msoulscat_Wac_DirectPrint:328,msoulscat_Wac_GraphValidation:329,msoulscat_Wac_OneNotePrint:330,msoulscat_Wac_AppSettings:331,msoulscat_Wac_Embed:332,msoulscat_Wac_SkypeChat:333,msoulscat_WAC_Accessibility:334,msoulscat_Wac_Aggregator:335,msoulscat_Wac_WordEditorPagination:336,msoulscat_WAC_WordEditorSave:337,msoulscat_Wac_WoncaGeneral:338,msoulscat_Wac_OneNoteGeneral:339,msoulscat_Wac_Ribbon:340,msoulscat_Wac_WordEditorAppsForOffice:341,msoulscat_Wac_SendUsYourFile:342,msoulscat_WAC_DocxSaveMonitor:343,msoulscat_Wac_AppsForOffice:344,msoulscat_Wac_BrowserPerformance:345,msoulscat_Wac_WordEditorShapes:346,msoulscat_Wac_WordEditorFeatureHelper:347,msoulscat_Wac_InsertSymbol:348,msoulscat_Wac_WebAppsPortal:349,msoulscat_Wac_Yammer:350,msoulscat_Wac_OoXml:351,msoulscat_Wac_InsertMedia:352,msoulscat_Wac_WordZoom:353,msoulscat_Wac_WordEditorFormatPainter:354,msoulscat_Wac_WordRealTimeTyping:355,msoulscat_Wac_WacFeedback:356,msoulscat_Wac_WacFeedbackExcelOnlineViewMode:357,msoulscat_Wac_WacFeedbackExcelOnlineEditMode:358,msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode:359,msoulscat_Wac_WacFeedbackPptOnlineViewMode:360,msoulscat_Wac_WacFeedbackPptOnlineEditMode:361,msoulscat_Wac_WacFeedbackOneNoteOnline:362,msoulscat_Wac_WacFeedbackWordOnlineViewMode:363,msoulscat_Wac_WacFeedbackWordOnlineEditMode:364,msoulscat_Wac_WordEditorUndo:365,msoulscat_Wac_WordEditorCustomXml:366,msoulscat_Wac_WordEditorNavigationPane:367,msoulscat_Wac_WordEditorContentControl:368,msoulscat_Wac_WordEditorExtension:369,msoulscat_OneService_Site:400,msoulscat_OneService_UnitTests:401,msoulscat_OneService_ClipperInstall:402,msoulscat_OneService_ClipperUsage:403,msoulscat_OneService_Site_EmailSettings:404,msoulscat_OneService_Site_Notebooks:405,msoulscat_OneService_Site_DevSite:406,msoulscat_OneService_Site_FeaturedApps:407,msoulscat_OneService_Site_FeedbackPage:408,msoulscat_OneService_Augmentation:409,msoulscat_OneService_AugmentationProvider_UrlEnhancer:410,msoulscat_OneService_AugmentationProvider_DomEnhancer:411,msoulscat_OneService_AugmentationProvider_Entitization:412,msoulscat_OneService_ClipperTooltip:413,msoulscat_OneService_Site_Students:414,msoulscat_OneService_AugmentationProvider_BizcardExtractor:415,msoulscat_OneService_Site_ClassNotebook:416,msoulscat_WAC_RealtimeChannel:500,msoulscat_WAC_RealtimeChannelTest:501,msoulscat_WAC_Signalr:600,msoulscat_WAC_VisioApp:700,msoulscat_WAC_VisioLoader:701,msoulscat_WAC_VisioDataModel:702,msoulscat_WAC_VisioRenderer:703,msoulscat_WAC_VisioRecalc:704,msoulscat_WAC_VisioCommand:705,msoulscat_WAC_VisioController:706,msoulscat_WAC_VisioShapePanel:707,msoulscat_WAC_VisioAppControls:708,msoulscat_WAC_VisioSync:709,msoulscat_Wac_PptAnimation:800,msoulscat_Wac_PptAppEvents:801,msoulscat_Wac_PptAppsForOffice:802,msoulscat_Wac_PptBrowserLayer:803,msoulscat_Wac_PptCoauthoring:804,msoulscat_Wac_PptComments:805,msoulscat_Wac_PptEditingManager:806,msoulscat_Wac_PptFocus:807,msoulscat_Wac_PptGraph:808,msoulscat_Wac_PptInit:809,msoulscat_Wac_PptNavigation:810,msoulscat_Wac_PptNone:811,msoulscat_Wac_PptNotes:812,msoulscat_Wac_PptPerf:813,msoulscat_Wac_PptPresence:814,msoulscat_Wac_PptShape:815,msoulscat_Wac_PptSelection:816,msoulscat_Wac_PptSession:817,msoulscat_Wac_PptTasks:818,msoulscat_Wac_PptThumbnailPane:819,msoulscat_Wac_PptText:820,msoulscat_Wac_PptUtil:821,msoulscat_Wac_PptView:822,msoulscat_Wac_PptSynchronization:823,msoulscat_Wac_PptWebService:824,msoulscat_Wac_PptMedia:825,msoulscat_Wac_PptCopyPaste:826,msoulscat_Wac_PptZoom:827,msoulscat_Uci_CommandsClient:1300,msoulscat_Uci_InsightsClient:1301,msoulscat_Uci_Assistance:1302,msoulscat_Uci_Insights:1303,msoulscat_Uci_Insights_Overview:1304,msoulscat_Uci_Insights_DrillIn:1306,msoulscat_Osf_Latency:1401,msoulscat_Osf_Notification:1402,msoulscat_Osf_Runtime:1403,msoulscat_Osf_AppManagementMenu:1404,msoulscat_Osf_InsertionDialogSession:1405,msoulscat_OneNoteOnline_Navigation:1600,msoulscat_Alchemy_Browser:1700,msoulscat_Ice_EmailHrd:1800,msoulscat_Ice_InsertMedia:1801,msoulscat_Met_Broadcast:1900},Diag.ULSCat.registerEnum("Diag.ULSCat",!1),Diag.LogCategory=function(){},Diag.LogCategory.prototype={msoSpLogging:200,wordMerge:300,wordViewer:301,wordPresence:302,revisionDiffer:303,wordCoauth:304,wacReplication:305,wacBrowserGeneral:306,box4CopyPaste:307,wordEditorFootnoteEndnote:308,wordEditorPageNumber:309,wacEventManager:310,wordEditorTableStyle:311,wordEditorFindReplace:312,wacFindReplace:313,wordEditorPageBreak:314,box4Crash:315,wordEditorBlobFormatting:316,wordEditorHeaderFooter:317,wacGraphValidation:329},Diag.LogCategory.registerEnum("Diag.LogCategory",!1),Diag.LogType=function(){},Diag.LogType.prototype={trace:0,assert:1},Diag.LogType.registerEnum("Diag.LogType",!1),Diag.IUlsHost=function(){},Diag.IUlsHost.registerInterface("Diag.IUlsHost"),Diag.ULSTraceLevel=function(){},Diag.ULSTraceLevel.prototype={error:10,warning:15,info:50,verbose:100,spam:200,shiftFactor:1e3},Diag.ULSTraceLevel.registerEnum("Diag.ULSTraceLevel",!1),Diag.LoggingArgs=function(e,t,s,i,a,o){this.timestamp=e,this.category=t,this.tag=s,this.level=i,this.message=a||"",this.logType=o},Diag.LoggingArgs.prototype={timestamp:0,category:0,tag:0,level:0,message:null,logType:0},Diag.UlsLoggingEventArgs=function(e){Diag.UlsLoggingEventArgs.initializeBase(this),this.args=e},Diag.UlsLoggingEventArgs.prototype={args:null},Diag.UlsHostStub=function(){},Diag.UlsHostStub.prototype={handleTrace:function(e){},showAssertDialog:function(e){},handoffToNewHost:function(e){},flushAsynchronous:function(){},add_onUlsTrace:function(e){},remove_onUlsTrace:function(e){},dispose:function(){}},Diag.LoggingArgs.registerClass("Diag.LoggingArgs"),Diag.UlsLoggingEventArgs.registerClass("Diag.UlsLoggingEventArgs",Sys.EventArgs),Diag.UlsHostStub.registerClass("Diag.UlsHostStub",null,Diag.IUlsHost,Sys.IDisposable),Type.registerNamespace("Diag"),Diag._iUlsImpl=function(){},Diag._iUlsImpl.registerInterface("Diag._iUlsImpl"),Diag.CachingUlsHost=function(e,t){this.$$d__reset$p$1=Function.createDelegate(this,this._reset$p$1),Diag.CachingUlsHost.initializeBase(this),this._appName$1=e,this._reset$p$1(t)},Diag.CachingUlsHost.prototype={_appName$1:null,_argsCache$1:null,_reset$p$1:function(e){this._argsCache$1=[],e||window.setTimeout(this.$$d__reset$p$1,Diag.CachingUlsHost._cacheDuration$p),Diag.ULS.sendTraceTag(3973958,101,50,"Reset")},handleTrace:function(e){e&&Array.add(this._argsCache$1,e)},handoffToNewHost:function(e){var t=this._argsCache$1.length;Diag.ULS.sendTraceTag(3973959,101,50,"Cached {0} logs",t);for(var s=0;s<t;s++)e.handleTrace(this._argsCache$1[s])},flushAsynchronous:function(){},get__argsCache$i$1:function(){return this._argsCache$1}},Diag._ulsImplStub=function(){this._host$0=new Diag.UlsHostStub},Diag._ulsImplStub.prototype={get_host:function(){return this._host$0},set_host:function(e){return e},logImpl:function(e,t,s,i,a,o,l){},assertImpl:function(e,t,s,i,a){},shouldTrace:function(e,t){return!1},setTraceLevel:function(e){},get_ulsCallDepth:function(){return 0}},Diag.Log=function(){},Diag.Log._traceWithoutRetraceOnException$p=function(e,t,s){try{Diag.Log.traceTag(e,Diag.LogCategory.msoSpLogging,Diag.Log.Level.error,"Exception was thrown while {0}: {1}",t,s.toString())}catch(e){}},Diag.Log.traceTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];try{Diag.ULS.sendTraceTag.apply(null,[e,Diag.Log._logCatToUlsCat$p(t),Diag.Log._logLevelToUlsLevel$p(s),i].concat(a))}catch(t){Diag.Log._traceWithoutRetraceOnException$p(e,"logging",t)}},Diag.Log.shouldTrace=function(e,t){try{return Diag.ULS.shouldTrace(Diag.Log._logCatToUlsCat$p(e),Diag.Log._logLevelToUlsLevel$p(t))}catch(e){return Diag.Log._traceWithoutRetraceOnException$p(0,"checking ShouldTrace",e),!1}},Diag.Log.debugAssertTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];try{Diag.ULS.debugAssertTag.apply(null,[e,Diag.Log._logCatToUlsCat$p(t),s,i].concat(a))}catch(t){Diag.Log._traceWithoutRetraceOnException$p(e,"asserting",t)}},Diag.Log.shipAssertTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];try{Diag.ULS.shipAssertTag.apply(null,[e,Diag.Log._logCatToUlsCat$p(t),s,i].concat(a))}catch(t){Diag.Log._traceWithoutRetraceOnException$p(e,"asserting",t)}},Diag.Log._logCatToUlsCat$p=function(e){return e},Diag.Log._logLevelToUlsLevel$p=function(e){return e},Diag.Log.Level=function(){},Diag.Log.Level.prototype={spam:200,verbose:100,info:50,warning:15,error:10},Diag.Log.Level.registerEnum("Diag.Log.Level",!1),Diag.ULS=function(){},Diag.ULS.setUlsHost=function(e){Diag.ULS._isDisabled&&(Diag.ULS._impl=new Diag._ulsImpl),Diag.ULS._impl.set_host(e),Diag.ULS._isDisabled=!1},Diag.ULS.get_host=function(){return Diag.ULS._impl.get_host()},Diag.ULS.disable=function(){Diag.ULS._impl=new Diag._ulsImplStub,Diag.ULS._isDisabled=!0},Diag.ULS.sendTraceTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];Diag.ULS._impl.logImpl(e,t,s,0,!1,i,a)},Diag.ULS.shipAssertTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];Diag.ULS._impl.assertImpl(e,t,s,i,a)},Diag.ULS.debugAssertTag=function(e,t,s,i){for(var a=[],o=4;o<arguments.length;++o)a[o-4]=arguments[o];Diag.ULS._impl.assertImpl(e,t,s,i,a)},Diag.ULS.shouldTrace=function(e,t){return Diag.ULS._impl.shouldTrace(e,t)},Diag.ULS.setTraceLevel=function(e){Diag.ULS._impl.setTraceLevel(e)},Diag.ULS.get_ulsCallDepth=function(){return Diag.ULS._impl.get_ulsCallDepth()},Diag.ULS.concatArray=function(e){var t;return(t=[]).concat.apply(t,e).join("")},Diag.ULS.jsonSerialize=function(e){return window.JSON?JSON.stringify(e):Sys.Serialization.JavaScriptSerializer.serialize(e)},Diag.ULS.get__impl$i=function(){return Diag.ULS._impl},Diag.ULS.get__isDisabled$i=function(){return Diag.ULS._isDisabled},Diag._ulsImpl=function(){this._currentLevel$i$0=100,this._host$0=new Diag.UlsHostStub},Diag._ulsImpl._buildMessageString$i=function(e,t){if(!t||!t.length)return e||"";for(var s=0,i=t.length;s<i;++s){var a=t[s];if(a&&"object"==typeof a){var o=Object.getType(a).prototype.toString;if(o===Diag._ulsImpl._objectToStringPrototype$p||!o)if(1===a.nodeType)t[s]=Diag.ULS.concatArray([a.tagName,"#",a.id,".",a.className]);else try{t[s]=Diag.ULS.jsonSerialize(a)}catch(e){Diag.ULS.debugAssertTag(4862938,102,!1,"ULS.BuildMessageString: An object with a cyclic reference was logged",null),t[s]=e}}}return e?String.format.apply(null,[e].concat(t)):t.join(", ")},Diag._ulsImpl.prototype={get_ulsCallDepth:function(){return this._ulsCallDepth$0},_ulsCallDepth$0:0,_inHostTransition$0:!1,get_host:function(){return this._host$0},set_host:function(e){return e===this._host$0?e:this._inHostTransition$0?e:(this._inHostTransition$0=!0,e?(this._host$0.handoffToNewHost(e),this._host$0.dispose(),this._host$0=e):(this._host$0.dispose(),this._host$0=new Diag.UlsHostStub),this._inHostTransition$0=!1,e)},logImpl:function(e,t,s,i,a,o,l){if(!(!i&&!this.shouldTrace(t,s)||this._ulsCallDepth$0>Diag._ulsImpl._maxPriorUlsCallDepth$p)){a||this._ulsCallDepth$0++;try{var n=new Date,r=new Diag.LoggingArgs(n.getTime(),t,e,s,Diag._ulsImpl._buildMessageString$i(o,l),i);this._host$0.handleTrace(r)}finally{a||this._ulsCallDepth$0--}}},assertImpl:function(e,t,s,i,a){if(!s&&this._ulsCallDepth$0<=Diag._ulsImpl._maxPriorUlsCallDepth$p){this._ulsCallDepth$0++;try{var o=Diag._ulsImpl._buildMessageString$i(i,a);this.logImpl(e,t,10,1,!0,o,null);var l=["TagID: ",Diag.TaggingUtilities.getTagFromiTag(e),"\n\n",o],n=Diag.ULS.concatArray(l);this._host$0.showAssertDialog(n)}finally{this._ulsCallDepth$0--}}},shouldTrace:function(e,t){return t<=this._currentLevel$i$0},setTraceLevel:function(e){this._currentLevel$i$0=e}},Diag.UULS=function(){},Diag.TaggingUtilities=function(){},Diag.TaggingUtilities.getTagFromiTag=function(e){if(e<=Diag.TaggingUtilities._s_maxNumericTag$p)return e.toString();if(e>>>24>=Diag.TaggingUtilities._s_minOldSchemeHighByteValue$p)return String.fromCharCode.call(null,e>>>24&255,e>>>16&255,e>>>8&255,255&e);var t=Diag.TaggingUtilities._s_symbolSpace$p;return""+t.charAt(e>>>24&63)+t.charAt(e>>>18&63)+t.charAt(e>>>12&63)+t.charAt(e>>>6&63)+t.charAt(63&e)},Diag.TaggingUtilities.getiTagFromTag=function(e){var t=0;if((t=parseInt(e)).toString(10)===e&&t<=Diag.TaggingUtilities._s_maxNumericTag$p)return t;if(4===e.length)t=e.charAt(0)<<24|e.charAt(1)<<16|e.charAt(2)<<8|e.charAt(3);else{var s=Diag.TaggingUtilities._s_symbolSpace$p;t=s.indexOf(e.charAt(0))<<24|s.indexOf(e.charAt(1))<<18|s.indexOf(e.charAt(2))<<12|s.indexOf(e.charAt(3))<<6|s.indexOf(e.charAt(4))}return t},Diag.TaggingUtilities.reserveTag=function(e){return e},Diag.CachingUlsHost.registerClass("Diag.CachingUlsHost",Diag.UlsHostStub),Diag._ulsImplStub.registerClass("Diag._ulsImplStub",null,Diag._iUlsImpl),Diag.Log.registerClass("Diag.Log"),Diag.ULS.registerClass("Diag.ULS"),Diag._ulsImpl.registerClass("Diag._ulsImpl",null,Diag._iUlsImpl),Diag.UULS.registerClass("Diag.UULS"),Diag.TaggingUtilities.registerClass("Diag.TaggingUtilities"),Diag.CachingUlsHost._cacheDuration$p=6e4,Diag.ULS._impl=new Diag._ulsImpl,Diag.ULS._isDisabled=!1,Diag._ulsImpl._objectToStringPrototype$p=Object.prototype.toString,Diag._ulsImpl._maxPriorUlsCallDepth$p=1,Diag.UULS.trace=Diag.ULS.sendTraceTag,Diag.TaggingUtilities._s_symbolSpace$p="abcdefghijklmnopqrstuvwxyz0123456789",Diag.TaggingUtilities._s_maxNumericTag$p=65535,Diag.TaggingUtilities._s_minOldSchemeHighByteValue$p=36,Type.registerNamespace("Diag"),Diag.ILogCache=function(){},Diag.ILogCache.registerInterface("Diag.ILogCache"),Diag._serializableLogCache=function(e,t,s,i,a){this.T=e,this.L=t,this.S=s,this.I=i,this.V=a},Diag._logCache=function(e,t,s){this._sizeThresholdBytes$0=e,this._logMessageMaxChars$0=t,this._userSessionId$0=s,this.reset()},Diag._logCache._testJsonSerialize$i=function(e){return Diag.ULS.jsonSerialize(e)},Diag._logCache.prototype={_timestampBase$0:0,_logs$0:null,_userSessionId$0:null,_dataSizeBytes$0:0,_sizeThresholdBytes$0:0,_logMessageMaxChars$0:0,reset:function(){this._logs$0=[],this._dataSizeBytes$0=Diag._logCache._serializationEnvelopeSize$p,this._timestampBase$0=(new Date).getTime()},get_count:function(){return this._logs$0.length},_$$pf_UploadId$p$0:0,get_uploadId:function(){return this._$$pf_UploadId$p$0},set_uploadId:function(e){return this._$$pf_UploadId$p$0=e,e},addLog:function(e){if(e){e.message.length>this._logMessageMaxChars$0&&(e.message=e.message.substr(0,this._logMessageMaxChars$0-Diag._logCache._trimMessageLength$p)+"... [trimmed]",Diag.ULS.sendTraceTag(3465240,100,50,"Trimmed message for log {0}",Diag.TaggingUtilities.getTagFromiTag(e.tag)));var t=new Diag._serializableLogEntry(e.message,e.category,e.level,e.timestamp-this._timestampBase$0,e.logType,e.tag),s=t._computeSerializedLength$i$0();Array.add(this._logs$0,t),this._dataSizeBytes$0+=s}},get_isDataSizeThresholdExceeded:function(){return this._dataSizeBytes$0>this._sizeThresholdBytes$0},serialize:function(){return Diag.ULS.jsonSerialize(new Diag._serializableLogCache(this._timestampBase$0,this._logs$0,this._userSessionId$0,this.get_uploadId(),Diag._logCache._serializationSchemaVersion$p))},get__sizeThresholdBytes$i$0:function(){return this._sizeThresholdBytes$0},get__logMessageMaxChars$i$0:function(){return this._logMessageMaxChars$0},get__dataSizeBytes$i$0:function(){return this._dataSizeBytes$0},get__logs$i$0:function(){return this._logs$0},get__timestampBase$i$0:function(){return this._timestampBase$0}},Diag._serializableLogEntry=function(e,t,s,i,a,o){this.G=o,this.T=i,this.M=e,this.C=t,this.D=1e3*a+s},Diag._serializableLogEntry._charsInObj$i=function(e){return(""+e).length},Diag._serializableLogEntry.prototype={G:0,T:0,M:null,C:null,D:0,_computeSerializedLength$i$0:function(){return Diag._logCache._logEnvelopeSize$i+Diag._serializableLogEntry._charsInObj$i(this.G)+Diag._serializableLogEntry._charsInObj$i(this.T)+this.M.length+Diag._serializableLogEntry._charsInObj$i(this.C)+Diag._serializableLogEntry._charsInObj$i(this.D)}},Diag.UlsUtils=function(){},Diag.UlsUtils.get__standardUlsLevelMap$i=function(){return Diag.UlsUtils._standardUlsLevelMap_BackingField||(Diag.UlsUtils._standardUlsLevelMap_BackingField=[],Diag.UlsUtils._standardUlsLevelMap_BackingField[10]="Unexpected",Diag.UlsUtils._standardUlsLevelMap_BackingField[15]="Monitorable",Diag.UlsUtils._standardUlsLevelMap_BackingField[50]="Medium",Diag.UlsUtils._standardUlsLevelMap_BackingField[100]="Verbose",Diag.UlsUtils._standardUlsLevelMap_BackingField[200]="VerboseEx"),Diag.UlsUtils._standardUlsLevelMap_BackingField},Diag.UlsUtils.convertLevelToStandardUlsLevel=function(e){return Diag.UlsUtils.get__standardUlsLevelMap$i()[e]||Diag.UlsUtils._defaultStandardLevel$p},Diag.UlsUtils.convertMillisecondsToTimestamp=function(e){var t=new Date(e),s=[Diag.UlsUtils._addLeadingZerosFour$p(t.getUTCFullYear()),"-",Diag.UlsUtils._addLeadingZerosTwo$p(t.getUTCMonth()+1),"-",Diag.UlsUtils._addLeadingZerosTwo$p(t.getUTCDate()),"T",Diag.UlsUtils._addLeadingZerosTwo$p(t.getUTCHours()),":",Diag.UlsUtils._addLeadingZerosTwo$p(t.getUTCMinutes()),":",Diag.UlsUtils._addLeadingZerosTwo$p(t.getUTCSeconds()),".",Diag.UlsUtils._addLeadingZerosThree$p(t.getUTCMilliseconds()),"Z"];return Diag.ULS.concatArray(s)},Diag.UlsUtils._addLeadingZerosFour$p=function(e){return e<1e3?"0"+Diag.UlsUtils._addLeadingZerosThree$p(e):e.toString()},Diag.UlsUtils._addLeadingZerosThree$p=function(e){return e<100?"0"+Diag.UlsUtils._addLeadingZerosTwo$p(e):e.toString()},Diag.UlsUtils._addLeadingZerosTwo$p=function(e){return e<10?"0"+e:e.toString()},Diag.UlsUploadConfiguration=function(e,t,s,i,a,o,l){this._sizeThresholdBytes$i$0=65536,this._uploadCadenceMs$i$0=6e4,this._delayedLogHandlingCadenceMs$i$0=1e4,this._asyncUploadRequestTimeout$i$0=5e3,null!=e&&(this._logMessageMaxChars$i$0=e),null!=t&&(this._sizeThresholdBytes$i$0=t),null!=s&&(this._uploadCadenceMs$i$0=s),null!=i&&(this._throttlingTimeoutMs$i$0=i),null!=a&&(this._delayedLogHandlingCadenceMs$i$0=a),null!=o&&(this._asyncUploadRequestTimeout$i$0=o),null!=l&&(this._asyncOverride$i$0=l)},Diag.UlsUploadConfiguration.prototype={_logMessageMaxChars$i$0:3072,_throttlingTimeoutMs$i$0:2e3,_asyncOverride$i$0:!1},Diag.UploadingUlsHost=function(e,t,s){this.$$d__endThrottling$p$0=Function.createDelegate(this,this._endThrottling$p$0),this.$$d__flushImpl$i$0=Function.createDelegate(this,this._flushImpl$i$0),this.$$d__handleDelayedLogs$i$0=Function.createDelegate(this,this._handleDelayedLogs$i$0),s||(s=new Diag.UlsUploadConfiguration(null,null,null,null,null,null,null)),this._sessionId$0=e,this.uploadUrl=t,this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&(alert("!!DISABLING ULS!! due to mixed content between the HTTPS page and the HTTP bULS upload URL."),Diag.ULS.disable()),this._uploadCadenceMs$0=s._uploadCadenceMs$i$0,this._throttlingTimeoutMs$0=s._throttlingTimeoutMs$i$0,this._delayedLogHandlingCadenceMs$0=s._delayedLogHandlingCadenceMs$i$0,this._uploadRequestTimeout$0=s._asyncUploadRequestTimeout$i$0,this._asyncOverride$0=s._asyncOverride$i$0,this._logCache$0=new Diag._logCache(s._sizeThresholdBytes$i$0,s._logMessageMaxChars$i$0,e),this._resetCadenceTimer$p$0(),this._delayedLogBuffer$0=[],this._resetDelayedLoggingTimer$p$0()},Diag.UploadingUlsHost.prototype={uploadUrl:null,_failedUploadAttemptCount$0:0,_uploadCadenceMs$0:0,_throttlingTimeoutMs$0:0,_delayedLogHandlingCadenceMs$0:0,_uploadRequestTimeout$0:0,_asyncOverride$0:!1,_sessionId$0:null,nextUploadId:0,_logCache$0:null,_delayedLogBuffer$0:null,_ulsCallDepthAdjustment$0:0,_request$0:null,_disposing$0:!1,handleTrace:function(e){this.get_ulsCallDepth()>1?Array.add(this._delayedLogBuffer$0,e):(this._logCache$0.addLog(e),this.logIndicatesError(e)?(this._flushSynchronous$i$0("LogIndicatesError in HandleTrace"),Diag.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",Diag.TaggingUtilities.getTagFromiTag(e.tag))):this._logCache$0.get_isDataSizeThresholdExceeded()&&(this.flushAsynchronous(),Diag.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))},logIndicatesError:function(e){return!!e&&(1===e.logType||10===e.level)},dispose:function(){this._disposing$0||(this._disposing$0=!0,this.flushForAppClose(),Diag.ULS.setUlsHost(null),window.clearTimeout(this._asyncFlushTimeoutId$0),window.clearTimeout(this._delayedLoggingTimerId$0),window.clearTimeout(this._cadenceTimerId$0),this._asyncFlushTimeoutId$0=0,this._delayedLoggingTimerId$0=0,this._cadenceTimerId$0=0)},flushForAppClose:function(){this.set__mode$i$0(2),this._handleDelayedLogs$i$0(),this._sendAfterThrottling$i$0=!1,this._endThrottling$p$0(),this._flushSynchronous$i$0("FlushForAppClose")},uploadLogs:function(e,t){return!0},uploadSerializedLogs:function(e,t){var s=this._asyncOverride$0||!t;return this._request$0&&s||(this._request$0=new XMLHttpRequest),this._request$0.readyState&&4!==this._request$0.readyState?(Diag.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{UploadId:this.nextUploadId,XhrReadyState:this._request$0.readyState}),!1):(this._request$0.open("POST",this.uploadUrl,s),this._request$0.setRequestHeader("Content-Type","application/json"),this._request$0.setRequestHeader(Diag.UploadingUlsHost.sessionIdHeaderName,this._sessionId$0),s&&(this._request$0.timeout=this._uploadRequestTimeout$0),this.modifyHttpRequestBeforeUploading(this._request$0),this._request$0.send(e),!0)},onUploadException:function(e){this._request$0&&this._request$0.abort()},modifyHttpRequestBeforeUploading:function(e){},_setTimeoutToLogOriginAndExecute$p$0:function(e,t,s){return window.setTimeout((function(){Diag.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",t,s),e()}),t)},_delayedLoggingTimerId$0:0,_resetDelayedLoggingTimer$p$0:function(){window.clearTimeout(this._delayedLoggingTimerId$0),this._delayedLoggingTimerId$0=this._setTimeoutToLogOriginAndExecute$p$0(this.$$d__handleDelayedLogs$i$0,this._delayedLogHandlingCadenceMs$0,"ResetDelayedLoggingTimer")},get_ulsCallDepth:function(){return Diag.ULS.get_ulsCallDepth()+this._ulsCallDepthAdjustment$0},_handleDelayedLogs$i$0:function(){var e=this._delayedLogBuffer$0.length;if(e){var t=[];Array.addRange(t,this._delayedLogBuffer$0),this._delayedLogBuffer$0=[],Diag.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",{Count:e}),this._ulsCallDepthAdjustment$0++;for(var s=0;s<e;s++)this.handleTrace(t[s]);this._ulsCallDepthAdjustment$0--,this._resetDelayedLoggingTimer$p$0()}else this._resetDelayedLoggingTimer$p$0()},_cadenceTimerId$0:0,_resetCadenceTimer$p$0:function(){window.clearTimeout(this._cadenceTimerId$0),this._cadenceTimerId$0=this._setTimeoutToLogOriginAndExecute$p$0(this.$$d__flushImpl$i$0,this._uploadCadenceMs$0,"ResetCadenceTimer")},_throttlingTimeoutId$0:0,_mode$0:0,get__mode$i$0:function(){return this._mode$0},set__mode$i$0:function(e){return e?this._mode$0||(this._throttlingTimeoutId$0=this._setTimeoutToLogOriginAndExecute$p$0(this.$$d__endThrottling$p$0,this._throttlingTimeoutMs$0,"ThrottlingMode Setter")):(window.clearTimeout(this._throttlingTimeoutId$0),this._throttlingTimeoutId$0=0),this._mode$0=e,e},_endThrottling$p$0:function(){this.set__mode$i$0(0),this._sendAfterThrottling$i$0&&(this._sendAfterThrottling$i$0=!1,this._flushImpl$i$0())},_sendAfterThrottling$i$0:!1,_shouldThrottle$i$0:function(e){return 2===this.get__mode$i$0()||1===this.get__mode$i$0()&&!e},_flushSynchronous$i$0:function(e){Diag.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",e),this._flushImpl$i$0(!0)},_asyncFlushTimeoutId$0:0,flushAsynchronous:function(){this._flushAsynchronousInternal$i$0(0)},_flushAsynchronousInternal$i$0:function(e){this._asyncFlushTimeoutId$0||(this._asyncFlushTimeoutId$0=this._setTimeoutToLogOriginAndExecute$p$0(this.$$d__flushImpl$i$0,e,"FlushAsynchronous"))},_flushImpl$i$0:function(e){if(this._ulsCallDepthAdjustment$0++,window.clearTimeout(this._asyncFlushTimeoutId$0),this._asyncFlushTimeoutId$0=0,!this._logCache$0.get_count())return this._resetCadenceTimer$p$0(),void this._ulsCallDepthAdjustment$0--;if(this._shouldThrottle$i$0(e))return Diag.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",e?"sync":"async"),this._sendAfterThrottling$i$0=!0,void this._ulsCallDepthAdjustment$0--;var t;this.set__mode$i$0(e?2:1),this._resetCadenceTimer$p$0(),Diag.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",e?"sync":"async",this._logCache$0.get_count());try{t=this.uploadLogs(this._logCache$0,e)}catch(e){Diag.ULS.debugAssertTag(5838928,100,!1,e.message),this.onUploadException(e),t=!1}t?(this._logCache$0.reset(),this._failedUploadAttemptCount$0=0):(this._failedUploadAttemptCount$0++,this._failedUploadAttemptCount$0<Diag.UploadingUlsHost.maxUploadAttempts?this._flushAsynchronousInternal$i$0(Diag.UploadingUlsHost.retryDelay):(Diag.ULS.debugAssertTag(5838929,100,!1,"Failed to upload bULS logs; Clearing cached logs after {0} upload attempts!",Diag.UploadingUlsHost.maxUploadAttempts),this._logCache$0.reset(),this.nextUploadId++,this._failedUploadAttemptCount$0=0)),this._ulsCallDepthAdjustment$0--},showAssertDialog:function(e){},handoffToNewHost:function(e){},add_onUlsTrace:function(e){},remove_onUlsTrace:function(e){},get__logCache$i$0:function(){return this._logCache$0},set__logCache$i$0:function(e){return this._logCache$0=e,e},get__delayedLogBuffer$i$0:function(){return this._delayedLogBuffer$0},get__cadenceTimerId$i$0:function(){return this._cadenceTimerId$0},get__delayedLoggingTimerId$i$0:function(){return this._delayedLoggingTimerId$0},get__asyncFlushTimeoutId$i$0:function(){return this._asyncFlushTimeoutId$0},get__throttlingTimeoutId$i$0:function(){return this._throttlingTimeoutId$0},get__ulsCallDepthAdjustment$i$0:function(){return this._ulsCallDepthAdjustment$0},set__ulsCallDepthAdjustment$i$0:function(e){return this._ulsCallDepthAdjustment$0=e,e}},Diag.UploadingUlsHost._xmlHttpReadyState=function(){},Diag.UploadingUlsHost._xmlHttpReadyState.prototype={unInitialized:0,loading:1,loaded:2,interactive:3,complete:4},Diag.UploadingUlsHost._xmlHttpReadyState.registerEnum("Diag.UploadingUlsHost._xmlHttpReadyState",!1),Diag.UploadingUlsHost._throttlingMode=function(){},Diag.UploadingUlsHost._throttlingMode.prototype={noThrottling:0,throttleOnlyAsynchronous:1,throttleAll:2},Diag.UploadingUlsHost._throttlingMode.registerEnum("Diag.UploadingUlsHost._throttlingMode",!1),Diag._serializableLogCache.registerClass("Diag._serializableLogCache"),Diag._logCache.registerClass("Diag._logCache",null,Diag.ILogCache),Diag._serializableLogEntry.registerClass("Diag._serializableLogEntry"),Diag.UlsUtils.registerClass("Diag.UlsUtils"),Diag.UlsUploadConfiguration.registerClass("Diag.UlsUploadConfiguration"),Diag.UploadingUlsHost.registerClass("Diag.UploadingUlsHost",null,Diag.IUlsHost,Sys.IDisposable),Diag._logCache._trimMessageLength$p=13,Diag._logCache._serializationEnvelopeSize$p=25,Diag._logCache._serializationSchemaVersion$p=1,Diag._logCache._logEnvelopeSize$i=31,Diag.UlsUtils._defaultStandardLevel$p="VerboseEx",Diag.UlsUtils._standardUlsLevelMap_BackingField=null,Diag.UploadingUlsHost.defaultRemoteUlsUrl="RemoteUls.ashx",Diag.UploadingUlsHost.maxUploadAttempts=3,Diag.UploadingUlsHost.retryDelay=15e3,Diag.UploadingUlsHost.sessionIdHeaderName="X-UserSessionId";